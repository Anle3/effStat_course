"0","feat <- ""bm02"""
"0","feat_cat <- data_prep %>% dplyr::pull(!!feat) %>% class()"
"0",""
"0","#create rug for bm02"
"0","feat_rug <- data_prep %>%"
"0","  dplyr::pull(!!feat)"
"0","#plot"
"0","p <- pdp_data %>%"
"0","  ggplot(aes(x = !!rlang::sym(feat), y = 1 - .value)) + # 1 minus for event probability, not survival prob"
"0","  {"
"0","    if (feat_cat == ""numeric"")"
"0","      geom_line()"
"0","    else"
"0","      geom_col()"
"0","  } +"
"0","  facet_wrap("
"0","    ~ time_id,"
"0","    nrow = 2,"
"0","    labeller =  ggplot2::labeller("
"0","      time_id  = function(s) {"
"0","        rf_model$unique.death.times[as.numeric(s)] %>% round(3)"
"0","      },"
"0","      # construct time labels within the function"
"0","      .default = ggplot2::label_value"
"0","    )"
"0","  ) +"
"0","  ylab(""event probability"")"
"0",""
"0","p + ggplot2::geom_rug("
"0","  data = feat_rug %>%"
"0","    tibble::enframe(),"
"0","  mapping = ggplot2::aes(x = value),"
"0","  inherit.aes = F,"
"0","  sides = ""b"","
"0","  alpha = 1,"
"0","  col = ""#B3B3B3"""
"0",")"
