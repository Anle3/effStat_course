"0","library(biospear)"
"0","library(tidyverse)"
"0","library(GGally)"
"0",""
"0","#The simdata function generates p Gaussian unit-variance (σ = 1) biomarkers including autoregressive correlation (σ_ij = b.corr^|i-j|) within b.corr.by-biomarker blocks. "
"0","#The number of active biomarkers and their effect sizes (in log-scale) can be specified using q.main and beta.main for the true prognostic biomarkers and using q.inter "
"0","#and beta.inter for the true treatment-effect modifiers. A total of n patients is generated and randomly assigned to the experimental (coded as +0.5, with probability prob.tt) "
"0","#and control treatment (coded as -0.5). The treatment effect is specified using alpha.tt (in log-scale). Survival times are generated using a Weibull with shape wei.shape "
"0","#(i.e. 1 = exponential distribution) and patient-specific scale depending on the baseline median survival time m0 and the biomarkers values of the patient. "
"0","#Censor status is generated by considering independant censoring from a U(fu, fu + recr) distribution, reflecting a trial with recr years of accrual and fu years of follow-up. "
"0","#Another data set with the same characteristics as the one generated by simdata can be obtained by using the simdataV function."
"0",""
"0","n = 1500"
"0","p = 20"
"0",""
"0","# Set a seed for reproducibility"
"0","set.seed(567)"
"0",""
"0","# specify which biomarkers are prognostic"
"0","Xprog <- c(""bm01"",""bm02"",""bm03"",""bm04"")"
"0","# specify which biomarkers are predictive"
"0","Xpred <- c(""bm01"",""bm05"",""bm06"")"
"0",""
"0","Xprogpred <- dplyr::intersect(Xpred,Xprog)"
"0","XsolelyProg <- dplyr::setdiff(Xprog, Xpred)    # set differentiation "
"0","q = length(Xpred)"
"0",""
"0","dataBM <- biospear::simdata("
"0","  # the sample size"
"0","  n = n,"
"0","  # the number of biomarkers                          "
"0","  p = p,     "
"0","  # the number of true prognostic biomarkers."
"0","  q.main = 4 ,    "
"0","  # the number of true biomarkers interacting with the treatement."
"0","  q.inter = 3, "
"0","  # the treatment assignment probability."
"0","  prob.tt = 0.5,         "
"0","  # baseline median survival time. "
"0","  m0 = 5,            "
"0","  # the effect of the treatment (in log-scale)~ 0.37"
"0","  alpha.tt = -1,         "
"0","  # the effect of the prognostic biomarkers (in log-scale)"
"0","  beta.main = c(0.3, 0.6, 0.4, 0.1),    "
"0","  # the effect of the biomarkers interacting with the treatment (in log-scale)"
"0","  beta.inter = rep(-1.5, 3),    "
"0","  # the correlation between biomarker blocks"
"0","  b.corr = 0.8, "
"0","  # the size of the blocks of correlated biomarkers"
"0","  b.corr.by = 2,    "
"0","  # the shape parameter of the Weibull distribution"
"0","  wei.shape = 1,  "
"0","  # the recruitment period duration"
"0","  recr = 1,                             "
"0","  # the follow-up period duration                          "
"0","  fu = 10,                              "
"0","  # the scale multiplicative factor for times (i.e. 1 = times in years)                          "
"0","  timefactor = 1,                       "
"0","  # the list of the prognostic biomarkers (not mandatory).                          "
"0","  active.main = Xprog,    "
"0","  # the list of the biomarkers interacting with the treatment (not mandatory)."
"0","  active.inter = Xpred                  "
"0",")"
"0",""
"0","# Visualizing the correlation structure"
"0","ggcorr(dataBM , "
"0","       layout.exp = 1, "
"0","       label = TRUE, "
"0","       label_size = 2, "
"0","       hjust = 0.75, "
"0","       size = 3, "
"0","       color = ""grey50"")"
